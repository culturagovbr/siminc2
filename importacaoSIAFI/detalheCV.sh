#!/bin/bash

# Definição de variáveis
TAB='\t';
NULO='\\N';
LIDOS='lidos/';
LENDO='Lendo/';
SQLCOPY='sqlCopy/';
LOGPG='logPGsql.log';
FILE=$1;
DATAI=`date +%Y-%m-%d`" "`date +%H:%M:%S`;

# Início do LOG
echo "####################################">> ${FILELOG};
echo "Inicio do arquivo $1:	"`date`>> ${FILELOG};

contasNum() {
	operadorValor="";
	case $1 in
       		"J")
		operadorValor=1;
        ;;
       		"K")
		operadorValor=2;
        ;;
       		"L")
		operadorValor=3;
        ;;
       		"M")
		operadorValor=4;
        ;;
       		"N")
		operadorValor=5;
        ;;
       		"O")
		operadorValor=6;
        ;;
       		"P")
		operadorValor=7;
        ;;
       		"Q")
		operadorValor=8;
        ;;
       		"R")
		operadorValor=9;
        ;;
       		"}")
		operadorValor=0;
        ;;
		*)
		operadorValor=99;
	;;
	esac
}

# Início da geração do script !!!
echo -e "SET client_encoding TO 'LATIN5'; " >> ${FILE}.sql;
echo  "COPY siafi.convenio(  it_co_usuario, it_co_terminal_usuario, it_da_transacao, it_ho_transacao, it_co_ug_operador, it_in_operacao, it_nu_convenio, it_co_concedente, it_co_gestao_concedente, it_nu_original, it_nu_processo_convenio, it_co_convenente, it_co_gestao_convenente, it_nu_cpf_responsavel_convenente, it_nu_municipio_convenente, it_co_uf_convenente, it_in_esfera_administrativa, it_co_interveniente, it_nu_cpf_resp_interveniente, it_co_executor, it_nu_cpf_responsavel, it_da_inicio_vigencia, it_da_final_vigencia, it_da_celebracao, it_da_publicacao_convenio, it_va_contrapartida, it_in_situacao_convenio, it_nu_controle_aditivo_01, it_nu_controle_aditivo_02, it_nu_controle_aditivo_03, it_nu_controle_aditivo_04, it_nu_controle_aditivo_05, it_nu_controle_aditivo_06, it_nu_controle_aditivo_07, it_nu_controle_aditivo_08, it_nu_controle_aditivo_09, it_nu_controle_aditivo_10, it_nu_controle_aditivo_11, it_nu_controle_aditivo_12, it_nu_controle_aditivo_13, it_nu_controle_aditivo_14, it_nu_controle_aditivo_15, it_nu_controle_aditivo_16, it_nu_controle_aditivo_17, it_nu_controle_aditivo_18, it_nu_controle_aditivo_19, it_nu_controle_aditivo_20, it_nu_controle_aditivo_21, it_nu_controle_aditivo_22, it_nu_controle_aditivo_23, it_nu_controle_aditivo_24, it_nu_controle_aditivo_25, it_nu_controle_aditivo_26, it_nu_controle_aditivo_27, it_nu_controle_aditivo_28, it_nu_controle_aditivo_29, it_nu_controle_aditivo_30, it_nu_controle_aditivo_31, it_nu_controle_aditivo_32, it_nu_controle_aditivo_33, it_nu_controle_aditivo_34, it_nu_controle_aditivo_35, it_nu_controle_aditivo_36, it_nu_controle_aditivo_37, it_nu_controle_aditivo_38, it_nu_controle_aditivo_39, it_nu_controle_aditivo_40, it_nu_controle_aditivo_41, it_nu_controle_aditivo_42, it_nu_controle_aditivo_43, it_nu_controle_aditivo_44, it_nu_controle_aditivo_45, it_nu_controle_aditivo_46, it_nu_controle_aditivo_47, it_nu_controle_aditivo_48, it_nu_controle_aditivo_49, it_nu_controle_aditivo_50, it_nu_controle_aditivo_51, it_nu_controle_aditivo_52, it_nu_controle_aditivo_53, it_nu_controle_aditivo_54, it_nu_controle_aditivo_55, it_nu_controle_aditivo_56, it_nu_controle_aditivo_57, it_nu_controle_aditivo_58, it_nu_controle_aditivo_59, it_nu_controle_aditivo_60, it_tx_descricao_conveino_1, it_tx_descricao_conveino_2, it_tx_descricao_conveino_3, it_tx_descricao_conveino_4, it_tx_descricao_conveino_5, it_tx_descricao_conveino_6, it_tx_descricao_conveino_7, it_tx_justificativa_1, it_tx_justificativa_2, it_tx_justificativa_3, it_tx_justificativa_4, it_tx_justificativa_5, it_da_inadimplencia, it_co_motivo_inadimplencia, it_va_convenio, it_vacontrapartida_dolar, it_da_cancelamento_convenio, it_da_rescisao_convenio, it_da_conclusao_convenio, it_va_convenio_dolar, it_co_responsavel_concedente, it_tx_motivo_convenio, it_in_cadastro, it_co_banco, it_co_agencia, it_nu_cpf_mandatario, it_in_conversao )   FROM stdin;" >> ${FILE}.sql;
cat ${FILE} | grep ^[^CV*] | sed 's/\\/ /g' | sed 's/*/ /g' | while read LINHA;
do
	# 00001  00011  NUM     IT-CO-USUARIO
	CAMPO01=${LINHA:0:11}; if [ -z "$CAMPO01" ]; then CAMPO01=${NULO}; fi

	# 00012  00008  ALFANUM IT-CO-TERMINAL-USUARIO
	CAMPO02=${LINHA:11:8}; if [ -z "$CAMPO02" ]; then CAMPO02=${NULO}; fi

	# 00020  00027  00008  NUM     IT-DA-TRANSACAO (DDMMAAAA)
	CAMPO03=${LINHA:  23: 4}${LINHA:  21: 2}${LINHA:  19: 2}; if [ -z "$CAMPO03" ]; then CAMPO03=${NULO}; fi

	# 00028  00004  NUM     IT-HO-TRANSACAO
	CAMPO04=${LINHA:27:4}; if [ -z "$CAMPO04" ]; then CAMPO04=${NULO}; fi
	
	# 00032  00006  NUM     IT-CO-UG-OPERADOR
	CAMPO05=${LINHA:31:6}; if [ -z "$CAMPO05" ]; then CAMPO05=${NULO}; fi
	
 	# 00038  00001  ALFANUM IT-IN-OPERACAO
	CAMPO06=${LINHA:37:1}; if [ -z "$CAMPO06" ]; then CAMPO06=${NULO}; fi

	# 00039  00006  NUM     IT-NU-CONVENIO
	CAMPO07=${LINHA:38:6}; if [ -z "$CAMPO07" ]; then CAMPO07=${NULO}; fi

 	# 00045  00014  ALFANUM IT-CO-CONCEDENTE
	CAMPO08=${LINHA:44:14}; if [ -z "$CAMPO08" ]; then CAMPO08=${NULO}; fi

	# 00059  00005  NUM     IT-CO-GESTAO-CONCEDENTE
	CAMPO09=${LINHA:58:5}; if [ -z "$CAMPO09" ]; then CAMPO09=${NULO}; fi
 
 	# 00064  00020  ALFANUM IT-NU-ORIGINAL
	CAMPO10=${LINHA:63:20}; if [ -z "$CAMPO10" ]; then CAMPO10=${NULO}; fi
 
	# 00084  00020  ALFANUM IT-NU-PROCESSO-CONVENIO
	CAMPO11=${LINHA:83:20}; if [ -z "$CAMPO11" ]; then CAMPO11=${NULO}; fi
 
 	# 00104  00014  ALFANUM IT-CO-CONVENENTE
	CAMPO12=${LINHA:103:14}; if [ -z "$CAMPO12" ]; then CAMPO12=${NULO}; fi

 	# 00118  00005  NUM     IT-CO-GESTAO-CONVENENTE
	CAMPO13=${LINHA:117:5}; if [ -z "$CAMPO13" ]; then CAMPO13=${NULO}; fi

  	# 00123  00011  NUM     IT-NU-CPF-RESPONSAVEL-CONVENENTE
	CAMPO14=${LINHA:122:11}; if [ -z "$CAMPO14" ]; then CAMPO14=${NULO}; fi
 
   	# 00134  00004  NUM     IT-NU-MUNICIPIO-CONVENENTE
	CAMPO15=${LINHA:133:4}; if [ -z "$CAMPO15" ]; then CAMPO15=${NULO}; fi
	
	# 00138  00002  ALFANUM IT-CO-UF-CONVENENTE
	CAMPO16=${LINHA:137:2}; if [ -z "$CAMPO16" ]; then CAMPO16=${NULO}; fi
	
	# 00140  00001  ALFANUM IT-IN-ESFERA-ADMINISTRATIVA
	CAMPO17=${LINHA:139:1}; if [ -z "$CAMPO17" ]; then CAMPO17=${NULO}; fi
	
	# 00141  00014  ALFANUM IT-CO-INTERVENIENTE
	CAMPO18=${LINHA:140:14}; if [ -z "$CAMPO18" ]; then CAMPO18=${NULO}; fi
	
	# 00155  00011  NUM     IT-NU-CPF-RESP-INTERVENIENTE
	CAMPO19=${LINHA:154:11}; if [ -z "$CAMPO19" ]; then CAMPO19=${NULO}; fi
	
	# 00166  00014  ALFANUM IT-CO-EXECUTOR
	CAMPO20=${LINHA:165:14}; if [ -z "$CAMPO20" ]; then CAMPO20=${NULO}; fi
	
   	# 00180  00011  NUM     IT-NU-CPF-RESPONSAVEL
	CAMPO21=${LINHA:179:11}; if [ -z "$CAMPO21" ]; then CAMPO21=${NULO}; fi
			
	# 00191  00008  NUM     IT-DA-INICIO-VIGENCIA (DDMMAAAA)
	CAMPO22=${LINHA:194:4}${LINHA:192:2}${LINHA:190:2}; if [ -z "$CAMPO22" ]; then CAMPO22=${NULO}; fi
 
	# 00199  00008  NUM     IT-DA-FINAL-VIGENCIA (DDMMAAAA)
	CAMPO23=${LINHA:202:4}${LINHA:200:2}${LINHA:198:2}; if [ -z "$CAMPO23" ]; then CAMPO23=${NULO}; fi
 
 	# 00207  00008  NUM     IT-DA-CELEBRACAO (DDMMAAAA)
	CAMPO24=${LINHA:210:4}${LINHA:208:2}${LINHA:206:2}; 
	if [ -z $CAMPO24 ]; then
		CAMPO24=${NULO}; 
	else
	CAMPO24=${LINHA:210:4}${LINHA:208:2}${LINHA:206:2}
	fi
 
  	# 00215  00008  NUM     IT-DA-PUBLICACAO-CONVENIO (DDMMAAAA)
	CAMPO25=${LINHA:218:4}${LINHA:216:2}${LINHA:214:2}; if [ -z $CAMPO25 ]; then CAMPO25=${NULO}; fi
 
   	# 00223  00017  NUM     IT-VA-CONTRAPARTIDA (N15,2)
	CAMPO26=${LINHA:222:17};
	if [ -z $CAMPO26 ]; then
	CAMPO26=${NULO};
	else
		valor=${LINHA:238:1};
		contasNum $valor;
		if  [ $operadorValor -ne 99  ]; then
			CAMPO26="-"${LINHA:222:15}"."${LINHA:237:1}$operadorValor
		else
			CAMPO26=${LINHA:222:15}"."${LINHA:237:2}
		fi
	fi 
  
 	# 00240  00001  ALFANUM IT-IN-SITUACAO-CONVENIO
	CAMPO27=${LINHA:239:1}; if [ -z "$CAMPO27" ]; then CAMPO27=${NULO}; fi
 
   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-001, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO28=${LINHA:240:4}; if [ -z "$CAMPO28" ]; then CAMPO28=${NULO}; fi
 
   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-002, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO29=${LINHA:244:4}; if [ -z "$CAMPO29" ]; then CAMPO29=${NULO}; fi 

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-003, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO30=${LINHA:248:4}; if [ -z "$CAMPO30" ]; then CAMPO30=${NULO}; fi 

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-004, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO31=${LINHA:252:4}; if [ -z "$CAMPO31" ]; then CAMPO31=${NULO}; fi 

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-005, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO32=${LINHA:256:4}; if [ -z "$CAMPO32" ]; then CAMPO32=${NULO}; fi 

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-006, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO33=${LINHA:260:4}; if [ -z "$CAMPO33" ]; then CAMPO33=${NULO}; fi 

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-007, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO34=${LINHA:264:4}; if [ -z "$CAMPO34" ]; then CAMPO34=${NULO}; fi 

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-008, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO35=${LINHA:268:4}; if [ -z "$CAMPO35" ]; then CAMPO35=${NULO}; fi 

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-009, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO36=${LINHA:272:4}; if [ -z "$CAMPO36" ]; then CAMPO36=${NULO}; fi 

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-010, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO37=${LINHA:276:4}; if [ -z "$CAMPO37" ]; then CAMPO37=${NULO}; fi 

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-011, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO38=${LINHA:280:4}; if [ -z "$CAMPO38" ]; then CAMPO38=${NULO}; fi 

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-012, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO39=${LINHA:284:4}; if [ -z "$CAMPO39" ]; then CAMPO39=${NULO}; fi 

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-013, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO40=${LINHA:288:4}; if [ -z "$CAMPO40" ]; then CAMPO40=${NULO}; fi 

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-014, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO41=${LINHA:292:4}; if [ -z "$CAMPO41" ]; then CAMPO41=${NULO}; fi 

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-015, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO42=${LINHA:296:4}; if [ -z "$CAMPO42" ]; then CAMPO42=${NULO}; fi 

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-016, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO43=${LINHA:300:4}; if [ -z "$CAMPO43" ]; then CAMPO43=${NULO}; fi 

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-017, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO44=${LINHA:304:4}; if [ -z "$CAMPO44" ]; then CAMPO44=${NULO}; fi 

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-018, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO45=${LINHA:308:4}; if [ -z "$CAMPO45" ]; then CAMPO45=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-019, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO46=${LINHA:312:4}; if [ -z "$CAMPO46" ]; then CAMPO46=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-020, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO47=${LINHA:316:4}; if [ -z "$CAMPO47" ]; then CAMPO47=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-021, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO48=${LINHA:320:4}; if [ -z "$CAMPO48" ]; then CAMPO48=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-022, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO49=${LINHA:324:4}; if [ -z "$CAMPO49" ]; then CAMPO49=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-023, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO50=${LINHA:328:4}; if [ -z "$CAMPO50" ]; then CAMPO50=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-024, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO51=${LINHA:332:4}; if [ -z "$CAMPO51" ]; then CAMPO51=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-025, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO52=${LINHA:336:4}; if [ -z "$CAMPO52" ]; then CAMPO52=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-026, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO53=${LINHA:340:4}; if [ -z "$CAMPO53" ]; then CAMPO53=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-027, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO54=${LINHA:344:4}; if [ -z "$CAMPO54" ]; then CAMPO54=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-028, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO55=${LINHA:348:4}; if [ -z "$CAMPO55" ]; then CAMPO55=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-029, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO56=${LINHA:352:4}; if [ -z "$CAMPO56" ]; then CAMPO56=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-030, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO57=${LINHA:356:4}; if [ -z "$CAMPO57" ]; then CAMPO57=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-031, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO58=${LINHA:360:4}; if [ -z "$CAMPO58" ]; then CAMPO58=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-032, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO59=${LINHA:364:4}; if [ -z "$CAMPO59" ]; then CAMPO59=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-033, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO60=${LINHA:368:4}; if [ -z "$CAMPO60" ]; then CAMPO60=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-034, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO61=${LINHA:372:4}; if [ -z "$CAMPO61" ]; then CAMPO61=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-035, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO62=${LINHA:376:4}; if [ -z "$CAMPO62" ]; then CAMPO62=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-036, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO63=${LINHA:380:4}; if [ -z "$CAMPO63" ]; then CAMPO63=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-037, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO64=${LINHA:384:4}; if [ -z "$CAMPO64" ]; then CAMPO64=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-038, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO65=${LINHA:388:4}; if [ -z "$CAMPO65" ]; then CAMPO65=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-039, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO66=${LINHA:392:4}; if [ -z "$CAMPO66" ]; then CAMPO66=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-040, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO67=${LINHA:396:4}; if [ -z "$CAMPO67" ]; then CAMPO67=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-041, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO68=${LINHA:400:4}; if [ -z "$CAMPO68" ]; then CAMPO68=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-042, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO69=${LINHA:404:4}; if [ -z "$CAMPO69" ]; then CAMPO69=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-043, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO70=${LINHA:408:4}; if [ -z "$CAMPO70" ]; then CAMPO70=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-044, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO71=${LINHA:412:4}; if [ -z "$CAMPO71" ]; then CAMPO71=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-045, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO72=${LINHA:416:4}; if [ -z "$CAMPO72" ]; then CAMPO72=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-046, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO73=${LINHA:420:4}; if [ -z "$CAMPO73" ]; then CAMPO73=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-047, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO74=${LINHA:424:4}; if [ -z "$CAMPO74" ]; then CAMPO74=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-048, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO75=${LINHA:428:4}; if [ -z "$CAMPO75" ]; then CAMPO75=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-049, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO76=${LINHA:432:4}; if [ -z "$CAMPO76" ]; then CAMPO76=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-050, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO77=${LINHA:436:4}; if [ -z "$CAMPO77" ]; then CAMPO77=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-051, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO78=${LINHA:440:4}; if [ -z "$CAMPO78" ]; then CAMPO78=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-052, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO79=${LINHA:444:4}; if [ -z "$CAMPO79" ]; then CAMPO79=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-053, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO80=${LINHA:448:4}; if [ -z "$CAMPO80" ]; then CAMPO80=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-054, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO81=${LINHA:452:4}; if [ -z "$CAMPO81" ]; then CAMPO81=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-055, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO82=${LINHA:456:4}; if [ -z "$CAMPO82" ]; then CAMPO82=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-056, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO83=${LINHA:460:4}; if [ -z "$CAMPO83" ]; then CAMPO83=${NULO}; fi  

   	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-057, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO84=${LINHA:464:4}; if [ -z "$CAMPO84" ]; then CAMPO84=${NULO}; fi 
	
	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-058, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO85=${LINHA:468:4}; if [ -z "$CAMPO85" ]; then CAMPO85=${NULO}; fi
	
	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-059, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO86=${LINHA:472:4}; if [ -z "$CAMPO86" ]; then CAMPO86=${NULO}; fi
	
	# 00241  00240  ALFANUM IT-NU-CONTROLE-ADITIVO-060, CAMPO COM TAMANHO DE 4 BYTES QUE OCORRE 60 VEZES
	CAMPO87=${LINHA:476:4}; if [ -z "$CAMPO87" ]; then CAMPO87=${NULO}; fi
 
    # 00481  00490  ALFANUM IT-TX-DESCRICAO-CONVEINO-001  CAMPO DE 70 BYTES QUE OCORRE 7 VEZES
	CAMPO88=${LINHA:480:70}; if [ -z "$CAMPO88" ]; then CAMPO88=${NULO}; fi
	
	# 00481  00490  ALFANUM IT-TX-DESCRICAO-CONVEINO-002  CAMPO DE 70 BYTES QUE OCORRE 7 VEZES
	CAMPO89=${LINHA:550:70}; if [ -z "$CAMPO89" ]; then CAMPO89=${NULO}; fi
	
	# 00481  00490  ALFANUM IT-TX-DESCRICAO-CONVEINO-003  CAMPO DE 70 BYTES QUE OCORRE 7 VEZES
	CAMPO90=${LINHA:620:70}; if [ -z "$CAMPO90" ]; then CAMPO90=${NULO}; fi
	
	# 00481  00490  ALFANUM IT-TX-DESCRICAO-CONVEINO-004  CAMPO DE 70 BYTES QUE OCORRE 7 VEZES
	CAMPO91=${LINHA:690:70}; if [ -z "$CAMPO91" ]; then CAMPO91=${NULO}; fi
	
	# 00481  00490  ALFANUM IT-TX-DESCRICAO-CONVEINO-005  CAMPO DE 70 BYTES QUE OCORRE 7 VEZES
	CAMPO92=${LINHA:760:70}; if [ -z "$CAMPO92" ]; then CAMPO92=${NULO}; fi
	
	# 00481  00490  ALFANUM IT-TX-DESCRICAO-CONVEINO-006  CAMPO DE 70 BYTES QUE OCORRE 7 VEZES
	CAMPO93=${LINHA:830:70}; if [ -z "$CAMPO93" ]; then CAMPO93=${NULO}; fi
	
	# 00481  00490  ALFANUM IT-TX-DESCRICAO-CONVEINO-007  CAMPO DE 70 BYTES QUE OCORRE 7 VEZES
	CAMPO94=${LINHA:900:70}; if [ -z "$CAMPO94" ]; then CAMPO94=${NULO}; fi
	 
    # 00971  00350  ALFANUM IT-TX-JUSTIFICATIVA001 CAMPO DE 70 BYTES QUE OCORRE 5 VEZES
	CAMPO95=${LINHA:970:70}; if [ -z "$CAMPO95" ]; then CAMPO95=${NULO}; fi
	
	# 00971  00350  ALFANUM IT-TX-JUSTIFICATIVA002 CAMPO DE 70 BYTES QUE OCORRE 5 VEZES
	CAMPO96=${LINHA:1040:70}; if [ -z "$CAMPO96" ]; then CAMPO96=${NULO}; fi

    # 00971  00350  ALFANUM IT-TX-JUSTIFICATIVA003 CAMPO DE 70 BYTES QUE OCORRE 5 VEZES
	CAMPO97=${LINHA:1110:70}; if [ -z "$CAMPO97" ]; then CAMPO97=${NULO}; fi
	
	# 00971  00350  ALFANUM IT-TX-JUSTIFICATIVA004 CAMPO DE 70 BYTES QUE OCORRE 5 VEZES
	CAMPO98=${LINHA:1180:70}; if [ -z "$CAMPO98" ]; then CAMPO98=${NULO}; fi
	
	# 00971  00350  ALFANUM IT-TX-JUSTIFICATIVA005 CAMPO DE 70 BYTES QUE OCORRE 5 VEZES
	CAMPO99=${LINHA:1250:70}; if [ -z "$CAMPO99" ]; then CAMPO99=${NULO}; fi
 
  	# 01321  00008  NUM     IT-DA-INADIMPLENCIA (DDMMAAAA)
	CAMPO100=${LINHA:1324:4}${LINHA:1322:2}${LINHA:1320:2};
	 if [ -z $CAMPO100 ]; then 
	 	CAMPO100=${NULO};
	 else
		 CAMPO100=${LINHA:1324:4}${LINHA:1322:2}${LINHA:1320:2}
	 fi
 
    # 01329  00003  NUM     IT-CO-MOTIVO-INADIMPLENCIA
	CAMPO101=${LINHA:1328:3}; if [ -z "$CAMPO101" ]; then CAMPO101=${NULO}; fi
 
    # 01332  00017  NUM     IT-VA-CONVENIO (N15,2)
	CAMPO102=${LINHA:1331:17};
	if [ -z $CAMPO102 ]; then
	CAMPO102=${NULO};
	else
		valor=${LINHA:1347:1};
		contasNum $valor;
		if  [ $operadorValor -ne 99  ]; then
			CAMPO102="-"${LINHA:1331:15}"."${LINHA:1346:1}$operadorValor
		else
			CAMPO102=${LINHA:1331:15}"."${LINHA:1346:2}
		fi
	fi 
 
   	# 01349  00019  NUM     IT-VACONTRAPARTIDA-DOLAR (N15,4)
	CAMPO103=${LINHA:1348:19};
	if [ -z $CAMPO103 ]; then
	CAMPO103=${NULO};
	else
		valor=${LINHA:1366:1};
		contasNum $valor;
		if  [ $operadorValor -ne 99  ]; then
			CAMPO103="-"${LINHA:1348:15}"."${LINHA:1363:1}$operadorValor
		else
			CAMPO103=${LINHA:1348:15}"."${LINHA:1363:4}
		fi
	fi 
 
 	# 01368  00008  NUM IT-DA-CANCELAMENTO-CONVENIO (DDMMAAAA)
 	CAMPO104=${LINHA:1367:8};
 	
	if [ -z $CAMPO104 ]; then 
		CAMPO104=${NULO};
	else
		CAMPO104=${LINHA:1371:4}${LINHA:1369:2}${LINHA:1367:2}
	fi
 	 	
  	# 01376  00008  NUM     IT-DA-RESCISAO-CONVENIO (DDMMAAAA)
  	CAMPO105=${LINHA:1379:4}${LINHA:1377:2}${LINHA:1375:2};
	if [ -z $CAMPO105 ]; then 
		CAMPO105=${NULO};
	else
		CAMPO105=${LINHA:1379:4}${LINHA:1377:2}${LINHA:1375:2} 
    fi
    
  	# 01384  00008  NUM     IT-DA-CONCLUSAO-CONVENIO (DDMMAAAA)
  	CAMPO106=${LINHA:1387:4}${LINHA:1385:2}${LINHA:1383:2};
  	if [ -z $CAMPO106 ]; then 
  		CAMPO106=${NULO}; 
  	else
  		CAMPO106=${LINHA:1387:4}${LINHA:1385:2}${LINHA:1383:2};
  	fi
  
    # 01392  00019  NUM     IT-VA-CONVENIO-DOLAR (N15,4)
	CAMPO107=${LINHA:1391:19};
	if [ -z $CAMPO107 ]; then
	CAMPO107=${NULO};
	else
		valor=${LINHA:1409:1};
		contasNum $valor;
		if  [ $operadorValor -ne 99  ]; then
			CAMPO107="-"${LINHA:1391:15}"."${LINHA:1406:1}$operadorValor
		else
			CAMPO107=${LINHA:1391:15}"."${LINHA:1406:4}
		fi
	fi 
 
 	# 01411  00011  NUM     IT-CO-RESPONSAVEL-CONCEDENTE
	CAMPO108=${LINHA:1410:11}; if [ -z "$CAMPO108" ]; then CAMPO108=${NULO}; fi
 
 	# 01422  00156  ALFANUM IT-TX-MOTIVO-CONVENIO
	CAMPO109=${LINHA:1421:156}; if [ -z "$CAMPO109" ]; then CAMPO109=${NULO}; fi
 
  	# 01578  00001  NUM     IT-IN-CADASTRO
	CAMPO110=${LINHA:1577:1}; if [ -z "$CAMPO110" ]; then CAMPO110=${NULO}; fi
 
  	# 01579  00003  NUM     IT-CO-BANCO
	CAMPO111=${LINHA:1578:3}; if [ -z "$CAMPO111" ]; then CAMPO111=${NULO}; fi 
 
  	# 01582  00004  NUM     IT-CO-AGENCIA
	CAMPO112=${LINHA:1581:4}; if [ -z "$CAMPO112" ]; then CAMPO112=${NULO}; fi 
 
   	# 01586  00011  ALFANUM IT-NU-CPF-MANDATARIO
	CAMPO113=${LINHA:1585:11}; if [ -z "$CAMPO113" ]; then CAMPO113=${NULO}; fi
	
   	# 01597  00001  NUM     IT-IN-CONVERSAO
	CAMPO114=${LINHA:1596:1}; if [ -z "$CAMPO114" ]; then CAMPO114=${NULO}; fi
		
	REGBANCOORIGINAL=`expr $REGBANCOORIGINAL + 1`;
	echo -e $CAMPO01${TAB}$CAMPO02${TAB}$CAMPO03${TAB}$CAMPO04${TAB}$CAMPO05${TAB}$CAMPO06${TAB}$CAMPO07${TAB}$CAMPO08${TAB}$CAMPO09${TAB}$CAMPO10${TAB}$CAMPO11${TAB}$CAMPO12${TAB}$CAMPO13${TAB}$CAMPO14${TAB}$CAMPO15${TAB}$CAMPO16${TAB}$CAMPO17${TAB}$CAMPO18${TAB}$CAMPO19${TAB}$CAMPO20${TAB}$CAMPO21${TAB}$CAMPO22${TAB}$CAMPO23${TAB}$CAMPO24${TAB}$CAMPO25${TAB}$CAMPO26${TAB}$CAMPO27${TAB}$CAMPO28${TAB}$CAMPO29${TAB}$CAMPO30${TAB}$CAMPO31${TAB}$CAMPO32${TAB}$CAMPO33${TAB}$CAMPO34${TAB}$CAMPO35${TAB}$CAMPO36${TAB}$CAMPO37${TAB}$CAMPO38${TAB}$CAMPO39${TAB}$CAMPO40${TAB}$CAMPO41${TAB}$CAMPO42${TAB}$CAMPO43${TAB}$CAMPO44${TAB}$CAMPO45${TAB}$CAMPO46${TAB}$CAMPO47${TAB}$CAMPO48${TAB}$CAMPO49${TAB}$CAMPO50${TAB}$CAMPO51${TAB}$CAMPO52${TAB}$CAMPO53${TAB}$CAMPO54${TAB}$CAMPO55${TAB}$CAMPO56${TAB}$CAMPO57${TAB}$CAMPO58${TAB}$CAMPO59${TAB}$CAMPO60${TAB}$CAMPO61${TAB}$CAMPO62${TAB}$CAMPO63${TAB}$CAMPO64${TAB}$CAMPO65${TAB}$CAMPO66${TAB}$CAMPO67${TAB}$CAMPO68${TAB}$CAMPO69${TAB}$CAMPO70${TAB}$CAMPO71${TAB}$CAMPO72${TAB}$CAMPO73${TAB}$CAMPO74${TAB}$CAMPO75${TAB}$CAMPO76${TAB}$CAMPO77${TAB}$CAMPO78${TAB}$CAMPO79${TAB}$CAMPO80${TAB}$CAMPO81${TAB}$CAMPO82${TAB}$CAMPO83${TAB}$CAMPO84${TAB}$CAMPO85${TAB}$CAMPO86${TAB}$CAMPO87${TAB}$CAMPO88${TAB}$CAMPO89${TAB}$CAMPO90${TAB}$CAMPO91${TAB}$CAMPO92${TAB}$CAMPO93${TAB}$CAMPO94${TAB}$CAMPO95${TAB}$CAMPO96${TAB}$CAMPO97${TAB}$CAMPO98${TAB}$CAMPO99${TAB}$CAMPO100${TAB}$CAMPO101${TAB}$CAMPO102${TAB}$CAMPO103${TAB}$CAMPO104${TAB}$CAMPO105${TAB}$CAMPO106${TAB}$CAMPO107${TAB}$CAMPO108${TAB}$CAMPO109${TAB}$CAMPO110${TAB}$CAMPO111${TAB}$CAMPO112${TAB}$CAMPO113${TAB}$CAMPO114 >> ${FILE}.sql; 
done

# Compacta arquivo na pasta LIDOS
#tar -zcf ${LIDOS}${FILE}".tar.gz" ${FILE}

# Executa o script gerado
psql -h $PGHOST -U $PGUSER -d $PGDB -f ${FILE}".sql" >> ${FILELOG};

# Gera o LOG
echo "Linhas Processadas:	"`cat ${FILE}".sql" | wc -l` >> ${FILELOG};
echo -e $1${TAB}""`date +%Y-%m-%d`" "`date +%H:%M:%S`${TAB}$DATAI${TAB}""`date +%Y-%m-%d`" "`date +%H:%M:%S`${TAB}I${TAB}""`cat ${FILE}".sql" | wc -l` > ${SQLCOPY}logFileSql.sql;

# Compacta o script na pasta SQLCOPY
#tar -zcf ${SQLCOPY}${FILE}".sql.tar.gz" ${FILE}".sql"
#rm ${FILE}".sql"

# FIM
echo "Fim do arquivo $1:	"`date`>> ${FILELOG};
echo "####################################">> ${FILELOG};