<?php

/*

if( $_REQUEST['script'] ){
	/*
	$arr = array( 'ESTRATÉGIA DE SAÚDE DA FAMÍLIA',
'ESTRATÉGIA DE AGENTES COMUNITÁRIOS DE SAÚDE',
'SERVIÇO DE ASSISTÊNCIA DE ALTA COMPLEXIDADE EM NEUROCIRURGIA',
'SERVIÇO DE ATENÇÃO A DST/HIV/AIDS',
'SERVIÇO DE ATENÇÃO A SAÚDE AUDITIVA',
'SERVIÇO DE ATENÇÃO A SAÚDE REPRODUTIVA',
'SERVIÇO DE ATENÇÃO AO PACIENTE COM TUBERCULOSE',
'SERVIÇO DE ATENÇÃO AO PRÉ-NATAL, PARTO E NASCIMENTO',
'SERVIÇO DE ATENÇÃO DOMICILIAR',
'SERVIÇO DE ATENÇÃO EM SAÚDE BUCAL',
'SERVIÇO DE ATENÇÃO PSICOSSOCIAL',
'SERVIÇO DE CIRURGIA CARDIOVASCULAR',
'SERVIÇO DE CIRURGIA REPARADORA',
'SERVIÇO DE CIRURGIA TORÁCICA',
'SERVIÇO DE CONTROLE DE TABAGISMO',
'SERVIÇO DE DISPENSAÇÃO DE ÓRTESES, PRÓTESES E MATERIAIS ESPECIAIS',
'SERVIÇO DE ENDOCRINOLOGIA',
'SERVIÇO DE FARMÁCIA',
'SERVIÇO DE FISIOTERAPIA',
'SERVIÇO DE GASTROENTEROLOGIA',
'SERVIÇO DE HEMOTERAPIA',
'SERVIÇO DE NEFROLOGIA/UROLOGIA',
'SERVIÇO DE OFTALMOLOGIA',
'SERVIÇO DE ONCOLOGIA',
'SERVIÇO DE PNEUMOLOGIA',
'SERVIÇO DE PRÁTICAS INTEGRATIVAS E COMPLEMENTARES',
'SERVIÇO DE REABILITAÇÃO',
'SERVIÇO DE SUPORTE NUTRICIONAL',
'SERVIÇO DE TELEMEDICINA',
'SERVIÇO DE TRIAGEM NEONATAL',
'SERVIÇO DE URGÊNCIAS',
'SERVIÇO DE VIGILÂNCIA EM SAÚDE',
'SERVIÇO MÓVEL DE URGÊNCIA (EXCETO SAMU)',
'SERVIÇO POSTO DE COLETA DE MATERIAIS BIOLÓGICOS',
'SERVIÇO DE VIDEOLAPAROSCOPIA',
'SERVIÇO DE APOIO A SAÚDE DA FAMÍLIA',
'HOSPITAL-DIA',
'TRANSPLANTE',
'CIRURGIA VASCULAR',
'MEDICINA NUCLEAR',
'ATENÇÃO ESPECIALIZADA NO PROCESSO TRANSEXUALIZADOR',
'SERVIÇO DE BANCO DE TECIDOS',
'SERVIÇO DE TRAUMATOLOGIA ORTOPEDIA',
'SERVIÇO DE ATENÇÃO À SAÚDE DAS PESSOAS OSTOMIZADAS',
'SERVIÇO DE LABORATÓRIO DE PRÓTESE DENTÁRIA',
'SERVIÇO DE ATENÇÃO INTEGRAL EM HANSENÍASE',
'ATENÇÃO BÁSICA',
'SERVIÇO DE TELECONSULTORIA' );
	
	$arr2 = Array(
		array('SAÚDE DA FAMÍLIA','SAÚDE BUCAL (MODALIDADE I)','SAÚDE BUCAL (MODALIDADE II)'),
		array('ESTRATÉGIAS DE AGENTES COMUNITÁRIOS DE SAÚDE - EACS',
'ESTRATÉGIAS DE AGENTES COMUNITÁRIOS DE SAÚDE BUCAL (MODALIDADE I)',
'ESTRATÉGIAS DE AGENTES COMUNITÁRIOS DE SAÚDE BUCAL (MODALIDADE II)'),
		array('NEUROCIRURGIA DO TRAUMA E ANOMALIAS DO DESENVOLVIMENTO',
'COLUNA E NERVOS PERIFÉRICOS',
'TUMORES DO SISTEMA NERVOSO',
'NEUROCIRURGIA VASCULAR',
'TRATAMENTO NEUROCIRÚRGICO DA DOR FUNCIONAL',
'INVESTIGAÇÃO E CIRURGIA DE EPILEPSIA',
'TRATAMENTO ENDOVASCULAR',
'NEUROCIRURGIA FUNCIONAL ESTEREOTÁXICA',
'POLISSONOGRAFIA'),
		array('TESTAGEM E ACONSELHAMENTO',
'DIAGNÓSTICO E TRATAMENTO',
'DIAGNÓSTICO, TRATAMENTO E CAPACITAÇÃO TÉCNICA'),
		array('DIAGNÓSTICO, TRATAMENTO E REABILITAÇÃO AUDITIVA NA MÉDIA COMPLEXIDADE',
'DIAGNÓSTICO DIFERENCIAL, TRATAMENTO E REABILITAÇÃO AUDITIVA NA ALTA COMPLEXIDADE',
'TERAPIA FONOAUDIOLÓGICA',
'DIAGNÓSTICO EM AUDIOLOGIA/OTOLOGIA',
'IMPLANTE COCLEAR'),
		array('ATENÇÃO A INFERTILIDADE',
'CONTRACEPÇÃO CLÍNICA',
'LAQUEADURA',
'VASECTOMIA'),
		array('DIAGNÓSTICO E TRATAMENTO',
'TRATAMENTO MULTIDROGAS RESISTENTES'),
		array('ACOMPANHAMENTO DO PRÉ-NATAL DE BAIXO RISCO',
'ACOMPANHAMENTO DO PRÉ-NATAL DE ALTO RISCO',
'PARTO EM GESTAÇÃO DE  BAIXO RISCO',
'PARTO EM GESTAÇÃO DE  ALTO RISCO',
'CENTRO DE PARTO NORMAL'),
		array('ASSISTÊNCIA DOMICILIAR'),
		array('DENTÍSTICA',
'ENDODONTIA',
'PERIODONTIA CLÍNICA',
'MOLDAGEM/MANUTENÇÃO',
'CIRURGIA ORAL',
'CIRURGIA BUCO-MAXILO-FACIAL'),
		array('RESIDÊNCIA TERAPÊUTICA EM SAÚDE MENTAL',
'ATENDIMENTO PSICOSSOCIAL'),
		array('ELETROFISIOLOGIA',
'CIRURGIA CARDIOVASCULAR (ADULTO)',
'CiRURGIA CARDIOVASCULAR (CRIANÇA)',
'CIRURGIA VASCULAR',
'CARDIOLOGIA INTERVENCIONISTA (HEMODINÂMICA)',
'ENDOVASCULAR EXTRACARDÍACA'),
		array('TRATAMENTO DA LIPODISTROFIA DO PORTADOR DE HIV/AIDS',
'TRATAMENTO EM QUEIMADOS',
'TRATAMENTO DA LIPOATROFIA FACIAL DO PORTADOR DE HIV/AIDS'),
		array('CIRURGIA TORÁCICA'),
		array('ABORDAGEM E TRATAMENTO  DO FUMANTE'),
		array('OPM AUXILIARES DE LOCOMOÇÃO',
'OPM ORTOPÉDICAS',
'OPM AUDITIVAS',
'OPM OFTALMOLÓGICAS',
'OPM EM GASTROENTEROLOGIA', 
'OPM EM UROLOGIA',
'OPM EM ODONTOLOGIA',
'OPM BUCO-MAXILO-FACIAL',
'SUBSTITUIÇÃO/TROCA EM ÓRTESES/PRÓTESES',
'OPM EM QUEIMADOS',
'OPM EM NEFROLOGIA',
'OPM PROJETO OLHAR BRASIL'),
		array('DIAGNÓSTICO/TRATAMENTO DAS DOENÇAS ENDOCRINAS, METABÓLICAS E NUTRICIONAIS',
'CIRURGIA DE GLÂNDULAS ENDÓCRINAS'),
		array('DISPENSAÇÃO DE MEDICAMENTOS EXCEPCIONAIS/ESPECIAIS',
'FARMÁCIA POPULAR',
'FARMÁCIA COM MANIPULAÇÃO E HOMEOPÁTICA',
'DISPENSAÇÃO DE MEDICAMENTOS ESTRATÉGICOS',
'DISPENSAÇÃO DE MEDICAMENTOS BÁSICOS',
'FARMÁCIA HOSPITALAR'),
		array('ASSISTÊNCIA FISIOTERAPEUTICA EM ALTERAÇÕES OBSTÉTRICAS, NEONATAIS E UROGINECOLÓGICAS',
'ASSISTÊNCIA FISIOTERAPEUTICA EM ALTERAÇÕES ONCOLÓGICAS',
'ASSISTÊNCIA FISIOTERAPÊUTICA EM OFTALMOLOGIA',
'ASSISTÊNCIA FISIOTERAPÊUTICA CARDIOVASCULARES E PNEUMO-FUNCIONAIS',
'ASSISTÊNCIA FISIOTERAPÊUTICA NAS DISFUNÇÕES MÚSCULO ESQUELÉTICAS (TODAS AS ORIGENS)',
'ASSISTÊNCIA FISIOTERAPÊUTICA EM QUEIMADOS',
'ASSISTÊNCIA FISIOTERAPÊUTICA NAS ALTERAÇÕES EM NEUROLOGIA',
'DIAGNÓSTICO CINÉTICO FUNCIONAL'),
		array('TRATAMENTO CLÍNICO, CIRÚRGICO, REPARADOR E ACOMPANHAMENTO AO PACIENTE PORTADOR DE OBESIDADE GRAVE'),
		array('PROCEDIMENTOS DESTINADOS A OBTENÇÃO DO SANGUE P/FINS DE ASSISTÊNCIA HEMOTERÁPICA', 
'DIAGNÓSTICO EM HEMOTERAPIA',
'PROCEDIMENTOS ESPECIAIS EM HEMOTERAPIA',
'MEDICINA TRANSFUSIONAL'),
		array('TRATAMENTO DIALÍTICO',
'LITOTRIPSIA',
'CONFECÇÃO/INTERVENÇÃO DE ACESSOS PARA DIÁLISE',
'TRATAMENTO EM NEFROLOGIA EM GERAL'),
		array('DIAGNÓSTICO EM OFTALMOLOGIA',
'TRATAMENTO CLÍNICO DO APARELHO DA VISÃO',
'TRATAMENTO CIRÚRGICO DO APARELHO DA VISÃO',
'PROJETO OLHAR BRASIL'),
		array('ONCOLOGIA PEDIÁTRICA',
'HEMATOLOGIA',
'ONCOLOGIA CLÍNICA',
'RADIOTERAPIA',
'ONCOLOGIA CIRÍRGICA'),
		array('TRATAMENTO DE DOENÇAS DAS VIAS AÉREAS INFERIORES'),
		array('ACUPUNTURA',
'FITOTERAPIA',
'OUTRAS TÉCNICAS EM MEDICINA TRADICIONAL CHINESA',
'PRÁTICAS CORPORAIS/ATIVIDADE FÍSICA',
'HOMEOPATIA',
'TERMALISMO/CRENOTERAPIA',
'MEDICINA ANTROPOSÓFICA'),
		array('REABILITAÇÃO VISUAL',
'REABILITAÇÃO MENTAL/AUTISMO',
'REABILITAÇÃO FÍSICA',
'REABILITAÇÃO NAS MÚLTIPLAS DEFICIÊNCIAS'),
		array('ENTERAL',
'ENTERAL/PARENTERAL',
'ENTERAL/PARENTERAL COM MANIPULAÇÃO/FABRICAÇÃO'),
		array('EXAME ELETROCARDIOGRÁFICO POR TELEMEDICINA'),
		array('TRATAMENTO RECÉM NASCIDO COM HIPOTIREOIDISMO E FENILCETONÚRIA',
'TRATAMENTO RECÉM NASCIDO DOENÇAS FALCIFORMES',
'TRATAMENTO RECÉM-NASCIDO  FIBROSE CÍSTICA',
'TRATAMENTO RECÉM NASCIDO COM OUTRAS DOENÇAS CONGÊNITAS'),
		array('PRONTO SOCORRO GERAL',
'PRONTO SOCORRO ESPECIALIZADO',
'PRONTO ATENDIMENTO'),
		array('VIGILÂNCIA EPIDEMIOLÓGICA',
'VIGILÂNCIA SANITÁRIA',
'VIGILÂNCIA AMBIENTAL',
'NÚCLEO DE VIGILÂNCIA HOSPITALAR'),
		array('TRANSPORTE TERRESTRE',
'TRANSPORTE AÉREO',
'TRANSPORTE MARÍTIMO'),
		array('COLETA REALIZADA FORA DA ESTRUTURA LABORATORIAL'),
		array('DIAGNÓSTICA',
'CIRÚRGICA'),
		array('NASF 1','NASF 2'),
		array('SAÚDE MENTAL',
'AIDS',
'GERIÁTRICO',
'FIBROSE CÍSTICA',
'CIRÚRGICO/DIAGNÓSTICO',
'ACOMPANHAMENTO PÓS-TRANSPLANTE DE MEDULA ÓSSEA'),
		array('RIM',
'MEDULA ÓSSEA',
'CORAÇÃO',
'PULMÃO',
'CÓRNEA/ESCLERA',
'FÍGADO',
'PÂNCREAS',
'RETIRADA DE ÓRGÃOS',
'PELE',
'VÁLVULAS CARDÍACAS',
'OSTEOCONDROLIGAMENTOS',
'SEPARAÇÃO/AVALIAÇÃO BIOMICROSCÓPICA E CONSERVAÇÃO DA CÓRNEA/ESCLERA',
'CONTAGEM ENDOTELIAL CORNEANA',
'ACOMPANHAMENTO DE PACIENTE TRANSPLANTADO EXECUTANDO EXAMES DE RADIOLOGIA, LABORATÓRIO CLÍNICO, HEMOTERAPIA ULTRA-SONOGRAFIA E ANATOMIA PATOLÓGICA  BIOMÉDICO'),
		array('FÍSTULA ARTERIOVENOSA SEM ENXERTO','FÍSTULA ARTERIOVENOSA COM ENXERTO'),
		array('MEDICINA NUCLEAR IN VIVO',
'MEDICINA NUCLEAR IN VITRO',
'MEDICINA NUCLEAR IN VIVO POR TELEMEDICINA'),
		array('"SERVIÇO DE ASSISTÊNCIA AOS  INDIVÍDUOS QUE POSSUEM INDICAÇÃO PARA A REALIZAÇÃO DO PROCESSO TRANSEXUALIZADOR'),
		array('BANCO DE VÁLVULA CARDÍACA HUMANA',
'BANCO DE TECIDO MÚSCULO ESQUELÉTICO'),
		array('SERVIÇO DE TRAUMATOLOGIA E ORTOPEDIA',
'SERVIÇO DE TRAUMATOLOGIA E ORTOPEDIA PEDIÁTRICA (ATÉ 21 ANOS DE IDADE)',
'SERVIÇO DE TRAUMATOLOGIA E ORTOPEDIA DE URGÊNCIA'),
		array('ATENÇÃO ÀS PESSOAS OSTOMIZADAS I',
'ATENÇÃO ÀS PESSOAS OSTOMIZADAS II'),
		array('LABORATÓRIO REGIONAL DE PRÓTESE DENTÁRIA'),
		array('SERVIÇO DE ATENÇÃO INTEGRAL EM HANSENÍASE TIPO I',
'SERVIÇO DE ATENÇÃO INTEGRAL EM HANSENÍASE TIPO II',
'SERVIÇO DE ATENÇÃO INTEGRAL EM HANSENÍASE TIPO III'),
		array('ATENÇÃO BÁSICA','ATENÇÃO BÁSICA COM SAÚDE BUCAL'),
		array('SEGUNDA OPINIÃO FORMATIVA',
'TELECONSULTORIA ASSÍNCRONA',
'TELECONSULTORIA  SÍNCRONA')
	);
	
	foreach( $arr as $n => $d ){
		$sql = "INSERT INTO questionario.grupolinha ( grldsc, tblid ) VALUES ( '".$d."', 362 ) RETURNING grlid";
		$grlid = $db->pegaUm( $sql );
		
		foreach( $arr2[$n] as $c ){
			$sql = "INSERT INTO questionario.item ( itmdsc ) VALUES ( '".$c."' ) RETURNING itmid";
			$it = $db->pegaUm( $sql );
			
			$sql = "INSERT INTO questionario.linha ( itmid, grlid ) VALUES ( ".$it.", ".$grlid." )";
			$db->executar( $sql );
		}
	}
	$db->commit();


	$tblid = 508;
	$grcid = $db->pegaUm("INSERT INTO questionario.grupocoluna ( tblid, grcdsc ) VALUES ( ".$tblid.", '&nbsp;' ) RETURNING grcid");
	$grlid = $db->pegaUm("INSERT INTO questionario.grupolinha ( tblid, grldsc ) VALUES ( ".$tblid.", '&nbsp;' ) RETURNING grlid");
	
	$arr = array(5125,5038,5039,5040,5041,5042,5043,5126,5127,5128);

	foreach( $arr as $d ){
		$sql = "INSERT INTO questionario.coluna ( itmid, grcid, coltipo ) VALUES ( '".$d."', ".$grcid.", 'RA' )";
		$it = $db->executar( $sql );
	}

	
	$arr = array( 'SALA SEGURA PARA LOCALIZAÇÃO DOS EQUIPAMENTOS SERVIDORES',
'NÚMERO DE SERVIDORES',
'ARMÁRIOS (RACKS) PARA INSTALAÇÃO DE SERVIDORES',
'EQUIPAMENTO DE FIREWALL',
'EQUIPAMENTO ESPECÍFICO DE STORAGE (ARMAZENAMENTO DE DADOS) -CAPACIDADE TOTAL DE ARMAZENAMENTO',
'COMPUTADOR CENTRAL (SWITCH CORE E/OU DE DISTRIBUIÇÃO) – QUANTIDADE E CAPACIDADE',
'NÚMERO DE SWITCHES DE ACESSO À REDE',
'ÁREAS (SERVIÇOS, UNIDADES) SUPORTADAS PELA ESTRUTURA DE REDE EXISTENTE',
'NÚMERO DE ESTAÇÕES DE TRABALHO',
'TEMPO DE USO DAS ESTAÇÕES DE TRABALHO',
'QUANTIDADE E TIPO DE IMPRESSORA (LASER, JATO DE TINTA, CÓDIGO DE BARRAS)' );

	$grlid = 786;
	
	foreach( $arr as $d ){
		$sql = "INSERT INTO questionario.item ( itmdsc ) VALUES ( '".$d."' ) RETURNING itmid";
		$it = $db->pegaUm( $sql );
		
		$sql = "INSERT INTO questionario.linha ( itmid, grlid ) VALUES ( ".$it.", ".$grlid." )";
		$db->executar( $sql );
	}
	$db->commit();

}
*/

/* configurações */
ini_set("memory_limit", "1024M");
set_time_limit(300);
/* FIM configurações */

global $db;

if( !$_SESSION['rehuf_var']['entid'] ){
	print "<script>"
		. "    alert('Problema de acesso!');"
		. "    history.back(-1);"
		. "</script>";
	die;
}

$entid = $_SESSION['rehuf_var']['entid'];

include_once APPRAIZ . "includes/classes/questionario/Tela.class.inc";
include_once APPRAIZ . "includes/classes/questionario/GerenciaQuestionario.class.inc";
include_once APPRAIZ . "includes/classes/modelo/questionario/tabelas/Montatabela.class.inc";
if(!$_REQUEST['ajax']) include  	 APPRAIZ . "includes/cabecalho.inc";

if( $_POST['salvar_questionario'] && $_POST['idTabela'] ){
	$obMonta = new Montatabela();
	$obMonta->salvar();
}

$arrPerfil = pegaArrayPerfil();

if( in_array(PRF_EQAPOIOHU, $arrPerfil) || in_array(PRF_GESTORHU, $arrPerfil) || in_array(PRF_ADMREHUF, $arrPerfil) || $db->testa_superuser() ){
	$permitir = "S";
} else {
	$permitir = "N";
}

if( $_REQUEST['avaliacao'] == 'true' ){
	$titulo = "Programa Nacional de Re-estruturação dos Hospitais Universitários Federais - Avaliador";
	$queid = QUESTIONARIO_REHUF_AVALIADOR;
} else {
	$titulo = "Programa Nacional de Re-estruturação dos Hospitais Universitários Federais";
	$queid = QUESTIONARIO_REHUF;
}

$qrpid = pegaQrpidRehuf( $entid, $queid );

echo "<br>";
echo montarAbasArray(carregardadosmenurehuf(), $_SERVER['REQUEST_URI']);

/* montando cabeçalho */
monta_titulo( "REHUF", $titulo);
monta_cabecalho_rehuf($_SESSION['rehuf_var']['entid']);

?>
<table bgcolor="#f5f5f5" align="center" class="tabela" >
	<tr>
		<td>
		<fieldset style="width: 94%; background: #fff;"  >
			<legend>Questionário</legend>
			<?php
				$tela = new Tela( array("qrpid" => $qrpid, 'relatorio' => 'modulo=relatorio/relatorioQuestionario&acao=A', 'habilitado' => $permitir ) );
			?>
		</fieldset>
	</tr>
</table>
